<!DOCTYPE html>
<html lang="en-GB">
  <head>
    <meta charset="UTF-8">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="icon" type="image/x-icon" href="../images/favicon.png">
    <title>WheatherMan</title>
  </head>
  <body>
    <div id="app">
        <h1>WheatherMan</h1>
        <p>Find out whether you should bring that umbrella (or that mask)...</p>
        <input v-model="city" placeholder="City">
        <br><br>
        <button v-on:click="GetCityWeather">Submit</button>
        <br><br>
        <!-- Only display response if there is one -->
        <div id="data" v-if="Object.entries(response).length !== 0">
          <!-- Display error message if error returned from server -->
          <span id="error" v-if="response.hasOwnProperty('error')"> 
            Oops!
            <br>
            WheatherMan couldn't find that one...
            <br>
            Please enter a valid city.
          </span>
          <!-- Display data returned from server -->
          <span id="error" v-else="!response.hasOwnProperty('error')"> 
            City: {{city}}
          </span>
        </div>
    </div>
  </body>
  <script type = "text/JavaScript">
    var app = new Vue({
    el:"#app",
    data:{
        city: "",
        bringUmbrella: false,
        bringMask: false,
        typeOfWeather: "",
        next4Days: {},
        response: {},
    },
    methods:{
        GetCityWeather : getCityWeather 
    }
    })

    function getCityWeather (){
        console.log("getCityWeather called")
        let prom = fetch("http://localhost:5500/weather/" + this.city)
        prom.then( response => response.json())
        .then (response =>
        { this.response = response
        })
    }
  </script>
</html>
